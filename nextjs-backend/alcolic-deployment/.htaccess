RewriteEngine On

# ===== SUBDOMAIN ROUTING =====

# API Backend (api.alcolic.gnritservices.com)
RewriteCond %{HTTP_HOST} ^api\.alcolic\.gnritservices\.com$ [NC]
RewriteRule ^(.*)$ /api/$1 [L]

# Store Admin (store.alcolic.gnritservices.com)
RewriteCond %{HTTP_HOST} ^store\.alcolic\.gnritservices\.com$ [NC]
RewriteRule ^(.*)$ /store-admin/index.html [L]

# Main Admin (admin.alcolic.gnritservices.com)
RewriteCond %{HTTP_HOST} ^admin\.alcolic\.gnritservices\.com$ [NC]
RewriteRule ^(.*)$ /main-admin/index.html [L]

# User Web App (alcolic.gnritservices.com - main domain)
RewriteCond %{HTTP_HOST} ^alcolic\.gnritservices\.com$ [NC]
RewriteRule ^(.*)$ /user-web-app/index.html [L]

# ===== FALLBACK ROUTING =====

# If no subdomain matches, route to user web app
RewriteCond %{HTTP_HOST} !^api\. [NC]
RewriteCond %{HTTP_HOST} !^store\. [NC]
RewriteCond %{HTTP_HOST} !^admin\. [NC]
RewriteRule ^(.*)$ /user-web-app/index.html [L]

# ===== SECURITY HEADERS =====
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# ===== CORS HEADERS =====
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"

# ===== COMPRESSION =====
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# ===== CACHE CONTROL =====
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
</IfModule>
